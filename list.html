<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My Listings - Room List</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
  />
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
  </style>
</head>
<body class="bg-[#f7fcfb] min-h-screen">
  <!-- Header -->
  <header class="bg-[#2ea437] px-4 sm:px-6 lg:px-8">
    <div class="max-w-7xl mx-auto h-12 flex items-center justify-between">
      <div class="flex items-center space-x-8">
        <a href="#" class="text-white font-extrabold text-lg select-none">RentO</a>
      </div>
      <div class="hidden md:flex items-center space-x-6 text-white text-sm font-semibold">
        <a href="/home.html" class="hover:underline">Home</a>
        <a href="/about.html" class="hover:underline">About</a>
        <a href="/contact.html" class="hover:underline">Contact</a>
        <a href="/team.html" class="hover:underline">Team</a>
      </div>
      <div class="relative text-white text-sm font-semibold">
        <button id="accountBtn" aria-haspopup="true" aria-expanded="false" class="flex items-center space-x-1 focus:outline-none">
          <i class="fas fa-user-circle text-lg"></i>
          <span>My Account</span>
          <i class="fas fa-chevron-down text-xs"></i>
        </button>
        <div
          id="dropdownMenu"
          class="hidden absolute right-0 mt-1 w-40 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-20"
          role="menu"
          aria-orientation="vertical"
          aria-labelledby="accountBtn"
        >
          <a href="/profile.html" class="flex items-center justify-between px-4 py-2 text-sm text-gray-900 hover:bg-gray-100" role="menuitem">
            Profile
            <span class="ml-2 text-xs font-normal bg-[#d1f0c0] text-[#2ea437] rounded px-1.5 py-0.5 select-none">Owner</span>
          </a>
          <a href="/list.html" class="block px-4 py-2 text-sm text-gray-900 hover:bg-gray-100" role="menuitem">My Listings</a>
          <a href="/add.html" class="block px-4 py-2 text-sm text-gray-900 hover:bg-gray-100" role="menuitem">Add Room</a>
          <a href="/request.html" class="block px-4 py-2 text-sm text-gray-900 hover:bg-gray-100" role="menuitem">Booking Requests</a>
          <a href="/logout.html" class="block px-4 py-2 text-sm text-gray-900 hover:bg-gray-100" role="menuitem">Logout</a>
        </div>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto p-4 sm:p-8">
    <h1 class="text-2xl font-extrabold text-gray-900 mb-6">My Listings</h1>

    <!-- Search & Filters -->
    <section class="bg-white rounded-md shadow p-4 mb-8">
      <form id="filterForm" class="flex flex-col sm:flex-row sm:items-center sm:space-x-6 space-y-4 sm:space-y-0">
        <input
          type="text"
          id="searchInput"
          name="search"
          placeholder="Search by room name or location"
          class="flex-grow border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#2ea437]"
        />
        <select id="statusFilter" name="status" class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#2ea437]">
          <option value="">All Statuses</option>
          <option value="active">Active</option>
          <option value="inactive">Inactive</option>
          <option value="pending">Pending Approval</option>
        </select>
        <select id="cityFilter" name="city" class="border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#2ea437]">
          <option value="">All Cities/Areas</option>
          <option value="newyork">New York</option>
          <option value="losangeles">Los Angeles</option>
          <option value="chicago">Chicago</option>
          <option value="houston">Houston</option>
        </select>
        <div class="flex space-x-2">
          <input
            type="number"
            id="priceMin"
            name="priceMin"
            placeholder="Min Price"
            min="0"
            class="w-24 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#2ea437]"
          />
          <input
            type="number"
            id="priceMax"
            name="priceMax"
            placeholder="Max Price"
            min="0"
            class="w-24 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#2ea437]"
          />
        </div>
        <button
          type="submit"
          class="bg-[#2ea437] text-white px-5 py-2 rounded-md font-semibold hover:bg-[#279230] transition"
        >
          Filter
        </button>
      </form>
    </section>

    <!-- Listings Table -->
    <section class="overflow-x-auto bg-white rounded-md shadow">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th scope="col" class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Thumbnail</th>
            <th scope="col" class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Room Title</th>
            <th scope="col" class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Location</th>
            <th scope="col" class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Price</th>
            <th scope="col" class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Status</th>
            <th scope="col" class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Booking Status</th>
            <th scope="col" class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Date Added / Updated</th>
            <th scope="col" class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Analytics</th>
            <th scope="col" class="px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider">Actions</th>
          </tr>
        </thead>
        <tbody id="listingsBody" class="divide-y divide-gray-200 bg-white">
          <!-- Room listing rows inserted by JS -->
        </tbody>
      </table>
    </section>

    <!-- Pagination -->
    <nav aria-label="Pagination" class="mt-6 flex justify-center space-x-2">
      <button id="prevPage" class="px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50" disabled>
        Previous
      </button>
      <div id="paginationNumbers" class="flex space-x-1"></div>
      <button id="nextPage" class="px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100">
        Next
      </button>
    </nav>
  </main>

  <script>
    // Sample data for room listings
    const rooms = [
      {
        id: 1,
        title: "Cozy Downtown Apartment",
        thumbnail: "https://placehold.co/80x60?text=Apartment+1",
        location: "New York",
        price: 120,
        priceUnit: "night",
        status: "active",
        bookingStatus: "available",
        dateAdded: "2024-05-01",
        dateUpdated: "2024-05-10",
        views: 150,
        bookingRequests: 12,
        lastBookingDate: "2024-05-09",
      },
      {
        id: 2,
        title: "Modern Loft with City View",
        thumbnail: "https://placehold.co/80x60?text=Loft+2",
        location: "Los Angeles",
        price: 2000,
        priceUnit: "month",
        status: "inactive",
        bookingStatus: "booked",
        dateAdded: "2024-04-15",
        dateUpdated: "2024-04-20",
        views: 230,
        bookingRequests: 18,
        lastBookingDate: "2024-04-25",
      },
      {
        id: 3,
        title: "Quiet Suburban House",
        thumbnail: "https://placehold.co/80x60?text=House+3",
        location: "Chicago",
        price: 150,
        priceUnit: "night",
        status: "pending",
        bookingStatus: "available",
        dateAdded: "2024-05-05",
        dateUpdated: "2024-05-07",
        views: 90,
        bookingRequests: 5,
        lastBookingDate: "2024-05-06",
      },
      {
        id: 4,
        title: "Luxury Condo Near Beach",
        thumbnail: "https://placehold.co/80x60?text=Condo+4",
        location: "Houston",
        price: 1800,
        priceUnit: "month",
        status: "active",
        bookingStatus: "booked",
        dateAdded: "2024-03-20",
        dateUpdated: "2024-04-01",
        views: 320,
        bookingRequests: 25,
        lastBookingDate: "2024-04-28",
      },
      {
        id: 5,
        title: "Charming Studio Flat",
        thumbnail: "https://placehold.co/80x60?text=Studio+5",
        location: "New York",
        price: 90,
        priceUnit: "night",
        status: "active",
        bookingStatus: "available",
        dateAdded: "2024-05-11",
        dateUpdated: "2024-05-12",
        views: 75,
        bookingRequests: 8,
        lastBookingDate: "2024-05-11",
      },
      {
        id: 6,
        title: "Spacious Family Home",
        thumbnail: "https://placehold.co/80x60?text=Home+6",
        location: "Los Angeles",
        price: 2200,
        priceUnit: "month",
        status: "inactive",
        bookingStatus: "available",
        dateAdded: "2024-02-10",
        dateUpdated: "2024-03-01",
        views: 180,
        bookingRequests: 15,
        lastBookingDate: "2024-02-28",
      },
      {
        id: 7,
        title: "Downtown Penthouse Suite",
        thumbnail: "https://placehold.co/80x60?text=Penthouse+7",
        location: "Chicago",
        price: 300,
        priceUnit: "night",
        status: "active",
        bookingStatus: "booked",
        dateAdded: "2024-01-15",
        dateUpdated: "2024-01-20",
        views: 400,
        bookingRequests: 30,
        lastBookingDate: "2024-01-19",
      },
      {
        id: 8,
        title: "Cozy Cabin Retreat",
        thumbnail: "https://placehold.co/80x60?text=Cabin+8",
        location: "Houston",
        price: 130,
        priceUnit: "night",
        status: "pending",
        bookingStatus: "available",
        dateAdded: "2024-05-08",
        dateUpdated: "2024-05-09",
        views: 60,
        bookingRequests: 4,
        lastBookingDate: "2024-05-08",
      },
      {
        id: 9,
        title: "Modern Studio Downtown",
        thumbnail: "https://placehold.co/80x60?text=Studio+9",
        location: "New York",
        price: 110,
        priceUnit: "night",
        status: "active",
        bookingStatus: "available",
        dateAdded: "2024-04-25",
        dateUpdated: "2024-04-30",
        views: 210,
        bookingRequests: 20,
        lastBookingDate: "2024-04-29",
      },
      {
        id: 10,
        title: "Elegant Villa with Pool",
        thumbnail: "https://placehold.co/80x60?text=Villa+10",
        location: "Los Angeles",
        price: 3500,
        priceUnit: "month",
        status: "active",
        bookingStatus: "booked",
        dateAdded: "2024-03-05",
        dateUpdated: "2024-03-15",
        views: 500,
        bookingRequests: 40,
        lastBookingDate: "2024-03-14",
      }
    ];

    // Pagination variables
    const itemsPerPage = 5;
    let currentPage = 1;
    let filteredRooms = [...rooms];

    // Elements
    const listingsBody = document.getElementById('listingsBody');
    const prevPageBtn = document.getElementById('prevPage');
    const nextPageBtn = document.getElementById('nextPage');
    const paginationNumbers = document.getElementById('paginationNumbers');
    const filterForm = document.getElementById('filterForm');

    // Render listings for current page
    function renderListings() {
      listingsBody.innerHTML = '';
      const start = (currentPage - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const pageItems = filteredRooms.slice(start, end);

      if (pageItems.length === 0) {
        listingsBody.innerHTML = `<tr><td colspan="9" class="text-center py-6 text-gray-500">No listings found.</td></tr>`;
        return;
      }

      pageItems.forEach(room => {
        const tr = document.createElement('tr');
        tr.className = 'hover:bg-gray-50';

        tr.innerHTML = `
          <td class="px-4 py-3 whitespace-nowrap">
            <img src="${room.thumbnail}" alt="Thumbnail image of ${room.title}" class="w-20 h-15 object-cover rounded" width="80" height="60" />
          </td>
          <td class="px-4 py-3 whitespace-nowrap text-gray-900 font-semibold">${room.title}</td>
          <td class="px-4 py-3 whitespace-nowrap text-gray-700">${room.location}</td>
          <td class="px-4 py-3 whitespace-nowrap text-gray-900 font-semibold">$${room.price} / ${room.priceUnit}</td>
          <td class="px-4 py-3 whitespace-nowrap">
            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${
              room.status === 'active' ? 'bg-green-100 text-green-800' :
              room.status === 'inactive' ? 'bg-gray-100 text-gray-800' :
              'bg-yellow-100 text-yellow-800'
            } capitalize">${room.status}</span>
          </td>
          <td class="px-4 py-3 whitespace-nowrap">
            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${
              room.bookingStatus === 'available' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
            } capitalize">${room.bookingStatus}</span>
          </td>
          <td class="px-4 py-3 whitespace-nowrap text-gray-600 text-sm">
            <div>Added: ${room.dateAdded}</div>
            <div>Updated: ${room.dateUpdated}</div>
          </td>
          <td class="px-4 py-3 whitespace-nowrap text-gray-700 text-sm space-y-1">
            <div><i class="fas fa-eye mr-1"></i> ${room.views}</div>
            <div><i class="fas fa-calendar-check mr-1"></i> ${room.bookingRequests} requests</div>
            <div><i class="fas fa-clock mr-1"></i> Last: ${room.lastBookingDate}</div>
          </td>
          <td class="px-4 py-3 whitespace-nowrap text-center space-y-1">
            <button data-id="${room.id}" class="editBtn bg-blue-600 text-white px-3 py-1 rounded text-xs w-full hover:bg-blue-700 transition">Edit</button>
            <button data-id="${room.id}" class="deleteBtn bg-red-600 text-white px-3 py-1 rounded text-xs w-full hover:bg-red-700 transition">Delete</button>
            <button data-id="${room.id}" class="viewBtn bg-gray-600 text-white px-3 py-1 rounded text-xs w-full hover:bg-gray-700 transition">View Details</button>
            <button data-id="${room.id}" class="duplicateBtn bg-green-600 text-white px-3 py-1 rounded text-xs w-full hover:bg-green-700 transition">Duplicate</button>
          </td>
        `;
        listingsBody.appendChild(tr);
      });

      renderPagination();
    }

    // Render pagination numbers
    function renderPagination() {
      paginationNumbers.innerHTML = '';
      const totalPages = Math.ceil(filteredRooms.length / itemsPerPage);

      for (let i = 1; i <= totalPages; i++) {
        const btn = document.createElement('button');
        btn.textContent = i;
        btn.className = `px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 ${
          i === currentPage ? 'bg-[#2ea437] text-white border-[#2ea437]' : ''
        }`;
        btn.addEventListener('click', () => {
          currentPage = i;
          renderListings();
        });
        paginationNumbers.appendChild(btn);
      }

      prevPageBtn.disabled = currentPage === 1;
      nextPageBtn.disabled = currentPage === totalPages || totalPages === 0;
    }

    // Filter and search function
    function applyFilters() {
      const searchTerm = filterForm.search.value.trim().toLowerCase();
      const status = filterForm.status.value;
      const city = filterForm.city.value;
      const priceMin = parseFloat(filterForm.priceMin.value);
      const priceMax = parseFloat(filterForm.priceMax.value);

      filteredRooms = rooms.filter(room => {
        const matchesSearch =
          room.title.toLowerCase().includes(searchTerm) ||
          room.location.toLowerCase().includes(searchTerm);

        const matchesStatus = status ? room.status === status : true;
        const matchesCity = city ? room.location.toLowerCase() === city.toLowerCase() : true;
        const matchesPriceMin = !isNaN(priceMin) ? room.price >= priceMin : true;
        const matchesPriceMax = !isNaN(priceMax) ? room.price <= priceMax : true;

        return matchesSearch && matchesStatus && matchesCity && matchesPriceMin && matchesPriceMax;
      });

      currentPage = 1;
      renderListings();
    }

    // Event listeners for pagination buttons
    prevPageBtn.addEventListener('click', () => {
      if (currentPage > 1) {
        currentPage--;
        renderListings();
      }
    });

    nextPageBtn.addEventListener('click', () => {
      const totalPages = Math.ceil(filteredRooms.length / itemsPerPage);
      if (currentPage < totalPages) {
        currentPage++;
        renderListings();
      }
    });

    // Filter form submit
    filterForm.addEventListener('submit', e => {
      e.preventDefault();
      applyFilters();
    });

    // Action buttons event delegation
    document.getElementById('listingsBody').addEventListener('click', e => {
      const target = e.target;
      const id = target.getAttribute('data-id');
      if (!id) return;
      const room = rooms.find(r => r.id === parseInt(id));

      if (target.classList.contains('editBtn')) {
        alert(`Edit room: ${room.title} (ID: ${room.id})`);
      } else if (target.classList.contains('deleteBtn')) {
        const confirmed = confirm(`Are you sure you want to delete "${room.title}"?`);
        if (confirmed) {
          const index = rooms.findIndex(r => r.id === room.id);
          if (index > -1) {
            rooms.splice(index, 1);
            applyFilters();
            alert(`Deleted room: ${room.title}`);
          }
        }
      } else if (target.classList.contains('viewBtn')) {
        alert(`View details for: ${room.title}`);
      } else if (target.classList.contains('duplicateBtn')) {
        const newId = rooms.reduce((max, r) => Math.max(max, r.id), 0) + 1;
        const duplicateRoom = {...room, id: newId, title: room.title + " (Copy)"};
        rooms.push(duplicateRoom);
        applyFilters();
        alert(`Duplicated room: ${room.title}`);
      }
    });

    // Header dropdown toggle
    const accountBtn = document.getElementById('accountBtn');
    const dropdownMenu = document.getElementById('dropdownMenu');
    accountBtn.addEventListener('click', () => {
      const isExpanded = accountBtn.getAttribute('aria-expanded') === 'true';
      if (isExpanded) {
        dropdownMenu.classList.add('hidden');
        accountBtn.setAttribute('aria-expanded', 'false');
      } else {
        dropdownMenu.classList.remove('hidden');
        accountBtn.setAttribute('aria-expanded', 'true');
      }
    });
    window.addEventListener('click', e => {
      if (!accountBtn.contains(e.target) && !dropdownMenu.contains(e.target)) {
        dropdownMenu.classList.add('hidden');
        accountBtn.setAttribute('aria-expanded', 'false');
      }
    });

    // Initial render
    renderListings();
  </script>
</body>
</html>